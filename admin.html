<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Årshjul – Admin</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%2372a3ff'/%3E%3C/svg%3E">
  <style>
    :root{ --bg:#0b1220; --fg:#e6eefc; --muted:#9fb0d3; --card:#101a33; --border:#1e2b4f; --accent:#72a3ff; }
    :root.light{ --bg:#ffffff; --fg:#0b1220; --muted:#52607a; --card:#ffffff; --border:#e5e7eb; --accent:#2b59ff; }
    *{box-sizing:border-box}
    body{margin:0; background:var(--bg); color:var(--fg); font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif}
    header{
      position:sticky; top:0; z-index:30;
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:12px;
      padding:12px 16px;
      background:#ffffff !important;
      border-bottom:1px solid #e5e7eb;
      color:#0b1220;
    }
    h1{margin:0; font-size:20px}
    .logo{height:32px; width:auto; display:block}
    @media (max-width:980px){ .logo{height:26px} }

    .wrap{max-width:900px; margin:20px auto; padding:0 16px; display:grid; gap:16px}
    .card{background:var(--card); border:1px solid var(--border); border-radius:14px; padding:14px}
    .row{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    .row3{display:grid; grid-template-columns:1fr 1fr 1fr; gap:12px}
    input,textarea,button,select{background:color-mix(in hsl, var(--card) 70%, black 10%); color:var(--fg); border:1px solid var(--border); border-radius:10px; padding:10px 12px}
    :root.light input,:root.light textarea,:root.light button,:root.light select{ background:color-mix(in hsl, var(--card) 85%, white 10%) }
    button{cursor:pointer}
    .pill{display:inline-flex; align-items:center; gap:8px; font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border)}
    a{color:var(--accent)}
    .hint{color:var(--muted); font-size:12px}
    .ok{color:#5bd6a2}
    .err{color:#ff7a7a}
    .chips{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px}
    .chip{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border:1px solid var(--border); border-radius:999px; background:var(--card); font-size:12px; cursor:pointer}

    .toolbar{display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin:8px 0 4px}
    .toolbar input[type="search"]{flex:1 1 220px}
    .count{font-size:12px; color:var(--muted); margin-left:auto}

    .event-item{border:1px solid var(--border); border-radius:10px; padding:12px; margin:8px 0; cursor:pointer; transition:all 0.2s}
    .event-item:hover{background:color-mix(in hsl, var(--card) 80%, var(--accent) 10%)}
    .event-item.editing{border-color:var(--accent); background:color-mix(in hsl, var(--card) 90%, var(--accent) 5%)}
    .event-title{font-weight:600; margin-bottom:4px}
    .event-meta{font-size:12px; color:var(--muted); display:flex; gap:12px; flex-wrap:wrap}
    .event-actions{margin-top:8px; display:flex; gap:8px}
    .btn-small{padding:4px 8px; font-size:11px; border-radius:6px; cursor:pointer; border:1px solid}
    .btn-edit{background:var(--accent); color:white; border-color:var(--accent)}
    .btn-delete{background:transparent; color:var(--err); border-color:var(--err)}
    .empty-state{text-align:center; padding:40px; color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <img class="logo" src="https://karlskoga.se/images/18.17cf90041722ce1749b5e/1640015633047/Karlskoga_liggande.png" alt="Karlskoga kommun">
    <h1>Årshjul admin – Socialförvaltningen</h1>
    <div style="margin-left:auto; display:flex; gap:8px; align-items:center">
      <label class="pill" style="gap:6px; cursor:pointer">
        <input id="themeSwitch" type="checkbox" />
        <span id="themeLabel">Mörkt</span>
      </label>
    </div>
  </header>

  <div class="wrap">
    <section class="card" aria-labelledby="catsHeading">
      <h2 id="catsHeading" style="margin:0 0 8px">Kategorier</h2>
      <div class="hint">Klicka för att välja en kategori, eller skriv en ny i fältet nedan.</div>
      <div id="catChips" class="chips"></div>
    </section>

    <section class="card" aria-labelledby="formTitle">
      <h2 style="margin:0 0 8px" id="formTitle">Lägg till händelse</h2>
      <div class="row" style="grid-template-columns:2fr 1fr">
        <input id="title" placeholder="Titel" />
        <input id="category" list="catlist" placeholder="Kategori (välj eller skriv ny)" />
        <datalist id="catlist"></datalist>
      </div>
      <div class="row3" style="margin-top:10px">
        <input id="start" type="date" />
        <input id="end" type="date" />
        <input id="color" type="color" value="#72a3ff" />
      </div>
      <div class="row" style="margin-top:10px">
        <input id="location" placeholder="Plats (valfritt)" />
        <input id="link" placeholder="Länk (valfritt)" />
      </div>
      <textarea id="desc" rows="4" placeholder="Beskrivning (valfritt)" style="margin-top:10px"></textarea>
      <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap">
        <button id="save"><span id="saveText">Spara händelse</span></button>
        <button id="clear" type="button">Töm formulär</button>
        <button id="cancel" type="button" style="display:none; background:var(--muted)">Avbryt redigering</button>
      </div>
      <div id="msg" class="hint" style="margin-top:10px"></div>
    </section>

    <!-- Flyttat hit längst ned -->
    <section class="card" aria-labelledby="eventsHeading">
      <div style="display:flex; align-items:center; gap:10px; justify-content:space-between">
        <h2 id="eventsHeading" style="margin:0 0 8px">Befintliga händelser</h2>
        <div class="count" id="eventsCount"></div>
      </div>
      <div class="hint">Klicka på "Redigera" för att ändra en händelse eller "Radera" för att ta bort den.</div>

      <div class="toolbar" role="region" aria-label="Filtrering och sök">
        <input id="search" type="search" placeholder="Sök titel, beskrivning, plats..." />
        <select id="catFilter" title="Filtrera på kategori">
          <option value="">Alla kategorier</option>
        </select>
        <button id="clearFilters" class="btn-small" type="button" title="Rensa filter">Rensa</button>
      </div>

      <div id="eventsList">
        <div class="empty-state">Laddar händelser...</div>
      </div>
    </section>
  </div>

<script>
// ... (JS-koden oförändrad) ...
</script>
</body>
</html>
